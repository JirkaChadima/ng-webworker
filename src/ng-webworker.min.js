/**
 * @license ng-webworker v0.1
 * (c) 2014 Matt Slocum
 * License: MIT
 */
!function(a,b,c){"undefined"!=typeof module&&module.exports?module.exports=c():"function"==typeof define&&define.amd?define(c):b[a]=c()}("ngWebworker",this,function(){"use strict";var a=angular.module("ngWebworker",[]);return a.service("webworker",["$q",function(a){function b(a,b){this.oWorker=new Worker(a),this.config=b||{}}function complete(a){postMessage({type:"complete",data:a})}function notify(a){postMessage({type:"notice",data:a})}this.create=function(a,c){var d,e,f,g,h=window.URL||window.webkitURL;return Worker&&h&&h.createObjectURL&&(Blob||BlobBuilder||WebKitBlobBuilder||MozBlobBuilder)&&("function"==typeof a?(d=/function\s*(\w+)(.*)/.exec(a.toString()),e=a.toString(),e+="self.onmessage=function(e){postMessage({type:'return', data:"+d[1]+".apply(null,e.data)})};",Blob?f=new Blob([complete,notify,e],{type:"application/javascript"}):(BlobBuilder||WebKitBlobBuilder||MozBlobBuilder)&&(window.BlobBuilder=BlobBuilder||WebKitBlobBuilder||MozBlobBuilder,f=new BlobBuilder,f.append(complete),f.append(notify),f.append(e),f=f.getBlob()),g=new b(h.createObjectURL(f),c)):g=new b(a,c)),g},b.prototype.run=function(){var b=a.defer(),c=this;return this.oWorker.onmessage=function(a){"return"==a.data.type?(c.config.async||b.resolve(a.data.data),"function"==typeof c.config.onReturn&&c.config.onReturn(a.data.data)):"complete"==a.data.type?(b.resolve(a.data.data),"function"==typeof c.config.onComplete&&c.config.onComplete(a.data.data)):"notice"==a.data.type&&"function"==typeof c.config.onNotice&&c.config.onNotice(a.data.data)},this.oWorker.postMessage(Array.prototype.slice.call(arguments)),b.promise}}]),a});